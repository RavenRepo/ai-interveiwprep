# ═══════════════════════════════════════════════════════════════
# application-dev.properties
# Development Profile — Local Development Overrides
# ═══════════════════════════════════════════════════════════════
# Activate with: ./mvnw spring-boot:run -Dspring-boot.run.profiles=dev
# Or set:        SPRING_PROFILES_ACTIVE=dev
#
# This profile provides relaxed defaults for local development.
# All secrets STILL come from environment variables (or .env file).
# This profile only overrides non-sensitive operational settings.
# ═══════════════════════════════════════════════════════════════

# ─── Database (local defaults) ────────────────────────────────
# In dev, default to localhost MySQL from docker-compose.yml
DB_HOST=localhost
DB_PORT=3306
DB_NAME=interview_platform

# ─── JPA / Hibernate ─────────────────────────────────────────
# For INITIAL setup only: use 'update' to let Hibernate create
# tables from entities. Once Flyway baseline migration is applied,
# switch back to 'validate' (the production default).
#
# IMPORTANT: If you already ran V1__baseline_schema.sql via Flyway,
# keep this as 'validate'. Only use 'update' if bootstrapping a
# brand new local database without Flyway migrations applied.
spring.jpa.hibernate.ddl-auto=validate
spring.jpa.show-sql=true
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE

# ─── HikariCP (smaller pool for local dev) ────────────────────
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=3
spring.datasource.hikari.leak-detection-threshold=30000

# ─── Flyway ───────────────────────────────────────────────────
# In dev, allow clean + migrate for easy schema resets.
# NEVER enable this in production.
spring.flyway.clean-disabled=false

# ─── File Upload ──────────────────────────────────────────────
spring.servlet.multipart.max-file-size=100MB
spring.servlet.multipart.max-request-size=100MB

# ─── Actuator (more permissive in dev) ────────────────────────
# Expose additional endpoints for debugging during development.
management.endpoints.web.exposure.include=health,info,metrics,env,beans,mappings,flyway
management.endpoint.health.show-details=always
management.endpoint.env.show-values=WHEN_AUTHORIZED

# ─── CORS (local frontend) ───────────────────────────────────
app.cors.allowed-origins=http://localhost:3000,http://localhost:5173

# ─── Logging (verbose for development) ────────────────────────
logging.level.root=INFO
logging.level.com.interview.platform=DEBUG
logging.level.com.interview.platform.config=DEBUG
logging.level.com.interview.platform.service=DEBUG
logging.level.com.interview.platform.controller=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=DEBUG
logging.level.org.flywaydb=DEBUG
logging.level.com.zaxxer.hikari=DEBUG

# ─── OpenAI (dev-friendly settings) ──────────────────────────
# Use gpt-4o-mini for cheaper local testing if desired.
# Override via env var: OPENAI_MODEL=gpt-4o-mini
openai.temperature=0.7
openai.max-tokens=2000

# ─── Virtual Threads ─────────────────────────────────────────
# Enabled in base config. No override needed here.
# spring.threads.virtual.enabled=true is inherited.

# ─── AWS S3 (dev notes) ──────────────────────────────────────
# For local development without real S3, consider using LocalStack:
#   docker run -d -p 4566:4566 localstack/localstack
# Then set:
#   AWS_ACCESS_KEY_ID=test
#   AWS_SECRET_ACCESS_KEY=test
#   AWS_S3_BUCKET_NAME=interview-platform-local
# And override the S3 endpoint in AWSS3Config (P1 migration adds
# endpoint-url support via AWS SDK v2).
